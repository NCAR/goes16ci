Using TensorFlow backend.
'./benchmark_output_final_64'
./benchmark_output_final_64 <class 'str'>
INFO:root:Begin serial load data
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190301T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190302T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190303T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190304T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190305T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190306T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190307T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190308T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190309T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190310T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190311T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190312T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190313T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190314T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190315T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190316T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190317T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190318T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190319T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190320T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190321T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190322T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190323T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190324T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190325T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190326T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190327T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190328T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190329T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190330T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190331T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190401T000000.nc
INFO:root:/glade/scratch/gwallach/goes16_nc/ABI_patches_20190315_64/abi_patches_20190402T000000.nc
INFO:root:Split training and testing data
          min         max       range
0  199.294525  256.655182   57.360657
1  197.486786  267.333221   69.846436
2  197.486343  273.109955   75.623611
3  196.431915  303.513977  107.082062
INFO:root:Single GPU Training
2020-01-15 17:11:57.471544: I tensorflow/core/platform/cpu_feature_guard.cc:145] This TensorFlow binary is optimized with Intel(R) MKL-DNN to use the following CPU instructions in performance critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in non-MKL-DNN operations, rebuild TensorFlow with the appropriate compiler flags.
2020-01-15 17:11:57.488392: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2300000000 Hz
2020-01-15 17:11:57.493428: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56164868fa40 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-01-15 17:11:57.493481: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
OMP: Info #212: KMP_AFFINITY: decoding x2APIC ids.
OMP: Info #210: KMP_AFFINITY: Affinity capable, using global cpuid leaf 11 info
OMP: Info #154: KMP_AFFINITY: Initial OS proc set respected: 0-71
OMP: Info #156: KMP_AFFINITY: 72 available OS procs
OMP: Info #157: KMP_AFFINITY: Uniform topology
OMP: Info #179: KMP_AFFINITY: 2 packages x 18 cores/pkg x 2 threads/core (36 total cores)
OMP: Info #214: KMP_AFFINITY: OS proc to physical thread map:
OMP: Info #171: KMP_AFFINITY: OS proc 0 maps to package 0 core 0 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 36 maps to package 0 core 0 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 1 maps to package 0 core 1 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 37 maps to package 0 core 1 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 2 maps to package 0 core 2 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 38 maps to package 0 core 2 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 3 maps to package 0 core 3 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 39 maps to package 0 core 3 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 4 maps to package 0 core 4 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 40 maps to package 0 core 4 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 5 maps to package 0 core 8 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 41 maps to package 0 core 8 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 6 maps to package 0 core 9 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 42 maps to package 0 core 9 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 7 maps to package 0 core 10 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 43 maps to package 0 core 10 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 8 maps to package 0 core 11 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 44 maps to package 0 core 11 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 9 maps to package 0 core 16 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 45 maps to package 0 core 16 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 10 maps to package 0 core 17 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 46 maps to package 0 core 17 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 11 maps to package 0 core 18 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 47 maps to package 0 core 18 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 12 maps to package 0 core 19 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 48 maps to package 0 core 19 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 13 maps to package 0 core 20 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 49 maps to package 0 core 20 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 14 maps to package 0 core 24 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 50 maps to package 0 core 24 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 15 maps to package 0 core 25 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 51 maps to package 0 core 25 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 16 maps to package 0 core 26 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 52 maps to package 0 core 26 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 17 maps to package 0 core 27 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 53 maps to package 0 core 27 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 18 maps to package 1 core 0 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 54 maps to package 1 core 0 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 19 maps to package 1 core 1 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 55 maps to package 1 core 1 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 20 maps to package 1 core 2 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 56 maps to package 1 core 2 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 21 maps to package 1 core 3 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 57 maps to package 1 core 3 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 22 maps to package 1 core 4 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 58 maps to package 1 core 4 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 23 maps to package 1 core 8 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 59 maps to package 1 core 8 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 24 maps to package 1 core 9 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 60 maps to package 1 core 9 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 25 maps to package 1 core 10 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 61 maps to package 1 core 10 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 26 maps to package 1 core 11 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 62 maps to package 1 core 11 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 27 maps to package 1 core 16 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 63 maps to package 1 core 16 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 28 maps to package 1 core 17 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 64 maps to package 1 core 17 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 29 maps to package 1 core 18 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 65 maps to package 1 core 18 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 30 maps to package 1 core 19 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 66 maps to package 1 core 19 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 31 maps to package 1 core 20 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 67 maps to package 1 core 20 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 32 maps to package 1 core 24 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 68 maps to package 1 core 24 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 33 maps to package 1 core 25 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 69 maps to package 1 core 25 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 34 maps to package 1 core 26 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 70 maps to package 1 core 26 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 35 maps to package 1 core 27 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 71 maps to package 1 core 27 thread 1 
OMP: Info #250: KMP_AFFINITY: pid 101500 tid 101500 thread 0 bound to OS proc set 0
2020-01-15 17:11:57.504148: I tensorflow/core/common_runtime/process_util.cc:115] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
WARNING:tensorflow:From /glade/u/home/gwallach/goes16ci/goes16ci/models.py:248: The name tf.keras.backend.set_session is deprecated. Please use tf.compat.v1.keras.backend.set_session instead.

WARNING:tensorflow:From /glade/u/home/gwallach/goes16ci/goes16ci/models.py:248: The name tf.keras.backend.set_session is deprecated. Please use tf.compat.v1.keras.backend.set_session instead.

WARNING:tensorflow:From /glade/u/home/gwallach/.conda/envs/goes16/lib/python3.7/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
WARNING:tensorflow:From /glade/u/home/gwallach/.conda/envs/goes16/lib/python3.7/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
ERROR:root:Traceback (most recent call last):
  File "/glade/u/home/gwallach/.conda/envs/goes16/lib/python3.7/site-packages/tensorflow_core/python/client/session.py", line 1365, in _do_call
    return fn(*args)
  File "/glade/u/home/gwallach/.conda/envs/goes16/lib/python3.7/site-packages/tensorflow_core/python/client/session.py", line 1348, in _run_fn
    self._extend_graph()
  File "/glade/u/home/gwallach/.conda/envs/goes16/lib/python3.7/site-packages/tensorflow_core/python/client/session.py", line 1388, in _extend_graph
    tf_session.ExtendSession(self._session)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device for operation conv2d_1/random_uniform/RandomUniform: {{node conv2d_1/random_uniform/RandomUniform}} was explicitly assigned to /device:GPU:0 but available devices are [ /job:localhost/replica:0/task:0/device:CPU:0, /job:localhost/replica:0/task:0/device:XLA_CPU:0 ]. Make sure the device specification refers to a valid device. The requested device appears to be a GPU, but CUDA is not enabled.
	 [[conv2d_1/random_uniform/RandomUniform]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "goes16_deep_learning_benchmark_64.py", line 100, in main
    1, config["random_seed"], dtype=config["dtype"])
  File "/glade/u/home/gwallach/goes16ci/goes16ci/models.py", line 255, in train_conv_net_gpu
    scn.fit(train_data, train_labels, val_x=val_data, val_y=val_labels)
  File "/glade/u/home/gwallach/goes16ci/goes16ci/models.py", line 144, in fit
    self.build_network(x_shape, y_size)
  File "/glade/u/home/gwallach/goes16ci/goes16ci/models.py", line 210, in build_network
    res_model = self.residual_block(num_filters, res_model, c)
  File "/glade/u/home/gwallach/goes16ci/goes16ci/models.py", line 185, in residual_block
    y = BatchNormalization(axis=norm_axis, name="bn_res_{0:02d}_a".format(layer_number))(x)
  File "/glade/u/home/gwallach/.conda/envs/goes16/lib/python3.7/site-packages/Keras-2.3.1-py3.7.egg/keras/engine/base_layer.py", line 489, in __call__
    output = self.call(inputs, **kwargs)
  File "/glade/u/home/gwallach/.conda/envs/goes16/lib/python3.7/site-packages/Keras-2.3.1-py3.7.egg/keras/layers/normalization.py", line 185, in call
    epsilon=self.epsilon)
  File "/glade/u/home/gwallach/.conda/envs/goes16/lib/python3.7/site-packages/Keras-2.3.1-py3.7.egg/keras/backend/tensorflow_backend.py", line 2309, in normalize_batch_in_training
    if not _has_nchw_support() and list(reduction_axes) == [0, 2, 3]:
  File "/glade/u/home/gwallach/.conda/envs/goes16/lib/python3.7/site-packages/Keras-2.3.1-py3.7.egg/keras/backend/tensorflow_backend.py", line 522, in _has_nchw_support
    gpus_available = len(_get_available_gpus()) > 0
  File "/glade/u/home/gwallach/.conda/envs/goes16/lib/python3.7/site-packages/Keras-2.3.1-py3.7.egg/keras/backend/tensorflow_backend.py", line 503, in _get_available_gpus
    devices = get_session().list_devices()
  File "/glade/u/home/gwallach/.conda/envs/goes16/lib/python3.7/site-packages/Keras-2.3.1-py3.7.egg/keras/backend/tensorflow_backend.py", line 385, in get_session
    return tf_keras_backend.get_session()
  File "/glade/u/home/gwallach/.conda/envs/goes16/lib/python3.7/site-packages/tensorflow_core/python/keras/backend.py", line 486, in get_session
    _initialize_variables(session)
  File "/glade/u/home/gwallach/.conda/envs/goes16/lib/python3.7/site-packages/tensorflow_core/python/keras/backend.py", line 903, in _initialize_variables
    [variables_module.is_variable_initialized(v) for v in candidate_vars])
  File "/glade/u/home/gwallach/.conda/envs/goes16/lib/python3.7/site-packages/tensorflow_core/python/client/session.py", line 956, in run
    run_metadata_ptr)
  File "/glade/u/home/gwallach/.conda/envs/goes16/lib/python3.7/site-packages/tensorflow_core/python/client/session.py", line 1180, in _run
    feed_dict_tensor, options, run_metadata)
  File "/glade/u/home/gwallach/.conda/envs/goes16/lib/python3.7/site-packages/tensorflow_core/python/client/session.py", line 1359, in _do_run
    run_metadata)
  File "/glade/u/home/gwallach/.conda/envs/goes16/lib/python3.7/site-packages/tensorflow_core/python/client/session.py", line 1384, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device for operation conv2d_1/random_uniform/RandomUniform: node conv2d_1/random_uniform/RandomUniform (defined at /glade/u/home/gwallach/.conda/envs/goes16/lib/python3.7/site-packages/tensorflow_core/python/framework/ops.py:1748)  was explicitly assigned to /device:GPU:0 but available devices are [ /job:localhost/replica:0/task:0/device:CPU:0, /job:localhost/replica:0/task:0/device:XLA_CPU:0 ]. Make sure the device specification refers to a valid device. The requested device appears to be a GPU, but CUDA is not enabled.
	 [[conv2d_1/random_uniform/RandomUniform]]

INFO:root:Monitor::monitor_process: unrecognized msg exit
